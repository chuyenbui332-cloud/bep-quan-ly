<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Menu - Qu·∫£n l√Ω b·∫øp</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <h1>üìã Qu·∫£n l√Ω Menu</h1>
    <!-- N√∫t quay l·∫°i trang ch·ªß -->
      <a href="index.html" class="btn btn-back">‚Üê V·ªÅ trang ch·ªß</a>
    </div>

    <!-- Form th√™m m√≥n -->
    <form id="addForm">
      <input type="text" id="tenmon" placeholder="T√™n m√≥n" required>
      <input type="number" id="giatien" placeholder="Gi√° b√°n (VNƒê)" required>
      <button type="submit" class="btn btn-green">‚ûï Th√™m m√≥n</button>
    </form>

  
    <!-- B·∫£ng danh s√°ch m√≥n ƒÉn -->
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>T√™n m√≥n</th>
          <th>Gi√° b√°n</th>
          <th>H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody id="menuTable">
        <!-- Render t·ª´ JS -->
      </tbody>
    </table>

  </div>

  <script>
    const API_URL = "/api/menu";

    // Load danh s√°ch m√≥n
    async function loadMenu() {
      const res = await fetch(API_URL);
      const data = await res.json();
      const table = document.getElementById("menuTable");
      table.innerHTML = "";
      data.forEach(mon => {
        const row = document.createElement("tr");
        row.innerHTML = 
          <td>${mon.idmon}</td>
          <td title="${mon.tenmon}">${mon.tenmon}</td>
          <td>${Number(mon.giatien).toLocaleString()} ƒë</td>
          <td>
            <button class="btn btn-yellow" onclick="editMon(${mon.idmon}, '${mon.tenmon}', ${mon.giatien})">‚úèÔ∏è S·ª≠a</button>
            <button class="btn btn-red" onclick="deleteMon(${mon.idmon})">üóëÔ∏è X√≥a</button>
          </td>
        ;
        table.appendChild(row);
      });
    }

    // Th√™m m√≥n
    document.getElementById("addForm").addEventListener("submit", async e => {
      e.preventDefault();
      const tenmon = document.getElementById("tenmon").value;
      const giatien = document.getElementById("giatien").value;
      await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ tenmon, giatien })
      });
      e.target.reset();
      loadMenu();
    });

    // S·ª≠a m√≥n
    async function editMon(idmon, oldTenmon, oldGiatien) {
      const tenmon = prompt("Nh·∫≠p t√™n m√≥n:", oldTenmon);
      const giatien = prompt("Nh·∫≠p gi√° b√°n:", oldGiatien);
      if (tenmon && giatien) {
        await fetch(${API_URL}/${idmon}, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ tenmon, giatien })
        });
        loadMenu();
      }
    }

    // X√≥a m√≥n
    async function deleteMon(idmon) {
      if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m√≥n n√†y?")) {
        await fetch(${API_URL}/${idmon}, { method: "DELETE" });
        loadMenu();
      }
    }

    // G·ªçi ngay khi m·ªü trang
    loadMenu();
   
  </script>
</body>
</html>
